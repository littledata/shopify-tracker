<script async src="https://www.googletagmanager.com/gtag/js?id=UA-57833108-2"></script>
<script>
	window.dataLayer = window.dataLayer || [];
	function gtag() {
		dataLayer.push(arguments);
	}
	gtag('js', new Date());

	/* ReCharge Analytics Code */
	gtag('config', 'UA-57833108-2', {
		linker: {
			domains: ['{{store.domain}}', 'myshopify.com'],
		},
	});
</script>

{% if store.google_analytics_type == 'UNIVERSAL' and store.google_analytics_id %}
<script>
	var emailRegex = /[\s&amp;\/,=]([a-zA-Z0-9_.+-]+(\@|%40)[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+)($|[\s&amp;\/,])/;
	function removePii(str) {
		return str.replace(emailRegex, 'REMOVED');
	};
	gtag('config', '{{store.google_analytics_id}}', {
		linker: {
			domains: ['{{store.domain}}', 'myshopify.com'],
		},
		page_title: removePii(document.title);,
		page_location: removePii(document.location.href);,
	});
</script>

{% elif store.google_analytics_id %}
<script>
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', '{{ store.google_analytics_id }}']);
	_gaq.push(['_trackPageview']);
	(function() {
		var ga = document.createElement('script');
		ga.type = 'text/javascript';
		ga.async = true;
		ga.src =
			('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0];
		s.parentNode.insertBefore(ga, s);
	})();
</script>
{% endif %}
