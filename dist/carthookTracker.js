(()=>{"use strict";var e={599:(e,t,n)=>{var r=n(798),o=n(402),a=n(257),c=n(354),i=n(259);!function(){o.getWebPropertyIdPromise().then((function(e){o.loadGtagScript(e),o.initGtag(e),o.sendCartId()}));var e="orderName"===r.getQueryStringParam(document.currentScript.src,"uniqueIdentifierForOrders")?"order_name":"order_number";window.CH.event((function(t,n){if("INITIATED_PAGE"==t){var r=o.getPageType();"checkout"===r&&a.sendCheckoutEvents(n),"upsell"===r&&i.sendUpsellDownsellEvents(),"thankyou"===r&&c.sendThankYouEvents(e)}}))}()},693:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.event_category="CartHook (Littledata)"},402:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(225),a=r(n(839));function c(){return location.pathname.includes("sandbox")?"https://transactions-staging.littledata.io":"https://transactions.littledata.io"}t.getWebPropertyIdPromise=function(){var e=c(),t=CHDataObject&&CHDataObject.store_urls&&CHDataObject.store_urls.store_url,n=location.pathname.includes("/checkout/"),r=window.localStorage&&window.localStorage.getItem("webPropertyId");return!n&&r?new Promise((function(e){e(r)})):function(e,t){return fetch("".concat(e,"/webProperty/").concat(t)).then((function(e){return e.json()})).then((function(e){return e.webPropertyId})).then((function(e){return function(e){return window.localStorage&&window.localStorage.setItem("webPropertyId",e),e}(e)}))}(e,t)},t.loadGtagScript=function(e){var t,n,r,o="https://www.googletagmanager.com/gtag/js?id=".concat(e);t=o,n=function(){},(r=document.createElement("script")).async=!0,r.src=t,r.onerror=function(){n(new Error("Failed to load"+t))},r.onload=function(){n()},document.getElementsByTagName("head")[0].appendChild(r)},t.initGtag=function(e){window.dataLayer=window.dataLayer||[],window.gtag=window.gtag||function(){dataLayer.push(arguments)},gtag("js",new Date),gtag("config",e,a.default())},t.sendCartId=function(){var e=c(),t="".concat(e,"/clientID"),n=o.getCookie("_ga"),r=o.getValidGAClientId(n);if(r){var a=function(e){return{headers:{"content-type":"application/json; charset=UTF-8"},body:JSON.stringify(e),method:"POST"}}({clientID:r,cartID:"carthook-".concat(CHDataObject.checkout_session)});fetch(t,a)}},t.getPageType=function(){var e=document.location.href;return e.includes("/checkout")?"checkout":e.includes("/oto")?"upsell":e.includes("/thank-you")?"thankyou":void 0},t.convertToGtagProducts=function(e){return e.map((function(e){return{id:e.sku||String(e.foreign_product_id),quantity:Number(e.quantity),price:Number(e.line_price||e.price||0).toFixed(2),name:e.title,variant:e.variant_title,brand:e.vendor}}))},t.sumProductTax=function(e){return e.reduce((function(e,t){return e+t.tax_amount||0}),0)},t.sumProductSubtotal=function(e){return e.reduce((function(e,t){return e+(t.price||0)*(t.quantity||0)}),0)},t.sumShipping=function(e){return e.reduce((function(e,t){return e+(t.price||0)}),0)}},257:(e,t,n)=>{function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(n,!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(t,"__esModule",{value:!0});var c=n(693),i=n(402),u="Checkout";t.sendCheckoutEvents=function(e){var t=e.cart_data,n=t.currency,r=t.coupon,a=i.convertToGtagProducts(t.line_items),d={event_category:c.event_category,currency:n,items:a,coupon:r};gtag("event",u,o({},d,{event_label:"Contact information",checkout_step:1}));var s=document.getElementById("customer_email"),l=document.getElementById("shipping_zip");s.addEventListener("blur",(function e(){gtag("event",u,o({},d,{event_label:"Shipping information",checkout_step:2})),s.removeEventListener("blur",e)})),l.addEventListener("blur",(function e(){gtag("event",u,o({},d,{event_label:"Payment method",checkout_step:3})),l.removeEventListener("blur",e)}))}},354:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});var r=n(402);t.sendThankYouEvents=function(e){if(window.chData){var t=window.chData.order,n=window.chData.last_charged_page_type,o=t.last_charged_line_items,a=t.line_items;if(o.length>0){var c=r.convertToGtagProducts(o),i=r.sumProductTax(o),u=r.sumProductSubtotal(o),d=r.sumShipping(t.last_charged_shipping_rates),s=i+u+d;window.dataLayer.push({event:"Transaction step completed",chTransactionId:t.carthook_order_id,transactionStepSubTotal:u,transactionStepTotal:s,transactionStepTax:i,transactionStepShipping:d,transactionStepProducts:c,stepCharged:n})}a.length>0&&window.dataLayer.push({event:"Transaction completed",transactionId:t[e],transactionSubTotal:r.sumProductSubtotal(a),transactionTotal:t.total_price,transactionTax:r.sumProductTax(a),transactionShipping:r.sumShipping(t.selected_shipping_rates),transactionProducts:r.convertToGtagProducts(a)})}else console.error("Littledata script unable to find chData")}},259:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});var r=n(693),o=n(402);t.sendUpsellDownsellEvents=function(){var e="upsell",t="Transaction step completed";"downsell_page"===window.CHDataObject.partial_type&&(t="Transaction step completed",e="downsell");for(var n="View ".concat(e," offer"),a=document.querySelector(".ch-accept-button"),c=document.querySelector(".ch-decline-button"),i=window.chData.order,u=i.carthook_order_id,d=o.convertToGtagProducts(window.chData.cart_data.line_items)[0],s=window.chData.last_charged_page_type,l=i.total_price,p=i.last_charged_line_items,g=o.convertToGtagProducts(p),f=o.sumProductTax(p),h=o.sumProductSubtotal(p),m=window.chData.order.last_charged_shipping_rates,v=0,_=0;_<m.length;_++)v+=parseFloat(m[_].price);g.length>0&&window.dataLayer.push({event:t,orderId:u,value:l,items:g,tax:f,subtotal:h,shipping:v,lastChargedPage:s});var y=d.id,w={event_category:r.event_category,event_label:y};gtag("event",n,w),a.addEventListener("click",(function(){gtag("event","Accepted ".concat(e," offer"),w)})),c.addEventListener("click",(function(){gtag("event","Rejected ".concat(e," offer"),w)}))}},839:(e,t,n)=>{function r(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}Object.defineProperty(t,"__esModule",{value:!0});var o=n(225);t.default=function(){var e=window.LittledataLayer||{},t=e.anonymizeIp,n=e.googleSignals,a=e.ecommerce,c=e.optimizeId,i=e.referralExclusion,u=e.extraLinkerDomains||[],d="string"==typeof i?new RegExp(i.replace(/^\//,"").replace(/\/$/,"")):i,s=d&&d.test(document.referrer);["shop.app"].includes(document.referrer)&&(s=!0),document.referrer.includes("".concat(location.protocol,"//").concat(location.host))&&(s=!0);var l={linker:{domains:[].concat(["^(?!cdn.)(.*)shopify.com","rechargeapps.com","recurringcheckout.com","carthook.com","checkout.com","shop.app"],r(u))},anonymize_ip:!1!==t,allow_ad_personalization_signals:!0===n,currency:a&&a.currencyCode||"USD",link_attribution:!0,optimize_id:c,page_referrer:s?null:document.referrer},p=e.customer&&e.customer.id;p&&(l.user_id=p);var g=o.getCookie("_ga");return g&&!o.getValidGAClientId(g)&&(l.cookie_expires=0),l}},225:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getCookie=function(e){if(document.cookie.length>0){var t=document.cookie.indexOf("".concat(e,"="));if(-1!==t){var n=t+e.length+1,r=document.cookie.indexOf(";",n);return-1===r&&(r=document.cookie.length),unescape(document.cookie.substring(n,r))}}return""},t.getValidGAClientId=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e.match(/(\d{2,11})\.(\d{2,11})/g);return t&&t[0]}},798:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getQueryStringParam=function(e,t){if(!e)return"";var n=e.match("".concat(t,"=([a-z,A-Z,0-9,-]+)"));return n&&n.length&&n[1]?n[1]:""}}},t={};!function n(r){if(t[r])return t[r].exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}(599)})();